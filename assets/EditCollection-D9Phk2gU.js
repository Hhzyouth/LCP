import{al as ke,t as d,an as Pe,am as Ne,K as se,az as Ce,r as Le,o as n,f as i,p as t,m as s,k as o,F as f,ao as Ve,ap as we,x as m,a7 as L,bo as xe,v as g,a6 as Se,j as b,g as q,aq as De,a9 as $e,at as Be,as as Fe,b9 as Me,ba as Ue,a8 as z,y as c,n as V,b8 as Te,au as Oe,av as Ae}from"./index-BXCC11IL.js";import{v as Je}from"./el-loading-eh5KfxWa.js";import{E as je,a as qe}from"./el-switch-DUwzh7gt.js";import"./el-overlay-f9f6fV6x.js";import{E as ze,a as Ge}from"./el-tab-pane-9eQCgsm8.js";import{E as Re}from"./el-pagination-BjaG3sPN.js";import{E as We}from"./el-tag-YOrmE4kc.js";import"./el-select-Bn9seCgH.js";import{E as He}from"./el-scrollbar-NpxurtvA.js";/* empty css                          */import{a as Ke,E as Qe}from"./el-checkbox-CvFIqMOL.js";import{E as Xe,a as Ye}from"./el-form-item-Q5sLgxw0.js";import{f as Ze,h as et,a as tt}from"./myProblem-Ce-xXOQ7.js";import{a as at}from"./problem-CuZVfpvr.js";import{E as lt}from"./el-message-box-BGRsEgrk.js";/* empty css                   */import{E as x}from"./index-e590A-XK.js";import"./use-dialog-BOZeEOsV.js";import"./validator-tQ-UPy4o.js";import"./strings-CBtOi6BX.js";import"./index-DW1qeJdV.js";import"./isEqual-W0GA-HSG.js";import"./_Uint8Array-KkRCjyoh.js";import"./debounce-DY7VrZO3.js";import"./castArray-BxmzwEdl.js";import"./_baseClone-ByGl8-Fj.js";import"./index-B1Dr4CYL.js";const G=w=>(Oe("data-v-ef75553f"),w=w(),Ae(),w),st={class:"Header-Main-container"},ot={class:"container"},nt={style:{width:"100%",display:"flex","justify-content":"end"}},ct=G(()=>t("div",{class:"main-header"},[t("div",{class:"edit"}),t("div",{class:"edit"}),t("div",{class:"status"},"状态"),t("div",{class:"id"},"编号"),t("div",{class:"name"},"题目"),t("div",{class:"level"},"难度"),t("div",{class:"tag"},"标签"),t("div",{class:"collection"},"题目集")],-1)),rt=["onDragstart","onDragenter"],it={class:"edit"},dt={class:"edit"},ut={class:"id"},mt={class:"tag"},vt={class:"collection"},pt=G(()=>t("div",{class:"main-header"},[t("div",{class:"check"}),t("div",{class:"status"},"状态"),t("div",{class:"id"},"编号"),t("div",{class:"name"},"题目"),t("div",{class:"level"},"难度"),t("div",{class:"tag"},"标签"),t("div",{class:"collection"},"题目集")],-1)),ft={class:"problem-list"},_t={class:"check"},gt={class:"id"},bt={class:"tag"},yt={class:"collection"},ht={key:0,style:{display:"flex",width:"100%","justify-content":"center"}},It=G(()=>t("div",{class:"main-header"},[t("div",{class:"check"}),t("div",{class:"status"},"状态"),t("div",{class:"id"},"编号"),t("div",{class:"name"},"题目"),t("div",{class:"level"},"难度"),t("div",{class:"tag"},"标签"),t("div",{class:"collection"},"题目集")],-1)),Et={class:"problem-list"},kt={class:"check"},Pt={class:"id"},Nt={class:"tag"},Ct={class:"collection"},Lt={key:0,style:{display:"flex",width:"100%","justify-content":"center"}},Vt={__name:"EditCollection",setup(w){const S=d(1),oe=Pe(),D=d(1),$=d(1),B=d(1),F=d(!1),M=Ne(),u=d([]),R=d([]),U=d("myProblem"),v=se({userId:M.userId,colId:null,colName:"",problemList:[]}),W=d(),T=d(!1),N=d(!1),ne=d(""),ce=(l,a)=>{lt.confirm(`题目 "${l}" 将从题目集中移出`,"警告",{confirmButtonText:"移出",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button el-button--danger"}).then(()=>{u.value.splice(a,1),x({type:"success",message:"题目已移出"})}).catch(()=>{x({type:"info",message:"已取消移出"})})},re=Ce(),{ec:H}=re.params,O=l=>{switch(l){case 1:case 2:return"简单";case 3:case 4:return"普通";case 5:case 6:return"中等";case 7:case 8:return"困难";case 9:case 10:return"炼狱";default:return"未定级"}},A=l=>{switch(l){case 1:case 2:return"level easy";case 3:case 4:return"level normal";case 5:case 6:return"level middle";case 7:case 8:return"level hard";case 9:case 10:return"level hell";default:return"level notKnow"}},K=l=>{const a=u.value.findIndex(_=>_.problemId===l);return a==-1?"":a+1},Q=d([]);let C=0;function ie(l,a){l.stopPropagation(),C=a,setTimeout(()=>{l.target.classList.add("moveing")},0)}function de(l,a){if(l.preventDefault(),C!==a){const _=u.value[C];u.value.splice(C,1),u.value.splice(a,0,_),C=a}}function ue(l){l.preventDefault(),l.dataTransfer.dropEffect="move"}function me(l){l.target.classList.remove("moveing")}H!=="0"&&Ze(parseInt(H)).then(l=>{console.log(l),v.colId=l.data.data.collection.colId,v.colName=l.data.data.collection.colName,N.value=l.data.data.collection.status===1,u.value=ve(l.data.data.problemList)}).catch(l=>{console.log(l),x.error("网络错误")});const ve=l=>{let a=[];for(let _ of l){const{problemId:p,userId:I,problemName:J,difficultyLevel:y,tag:j,collection:E}=_;a.push({problemId:p,userId:I,problemName:J,difficultyLevel:y,tag:j,collection:E})}return a},pe=se({colName:[{required:!0,message:"题目集名称不能为空",trigger:"blur"},{max:16,message:"题目集名称最大限制16个字符",trigger:"blur"}]}),fe=async l=>{l&&await l.validate((a,_)=>{if(a){console.log("submit!"),v.status=N.value?1:0,v.problemList=[];for(let p of u.value)v.problemList.push({problemId:p.problemId,problemName:p.problemName});et(v).then(p=>{console.log(p),p.data.code===200&&x({type:"success",message:"保存成功"})})}else console.log("error submit!",_)})},X=()=>{F.value=!0,tt(D.value).then(l=>{console.log(l),F.value=!1,Q.value=l.data.data,S.value=Math.ceil(l.data.num/30)})},Y=()=>{at($.value,[],[],M.userId).then(function(l){console.log(l),R.value=l.data.data.problemList,B.value=Math.ceil(l.data.data.num/30)})},_e=()=>{T.value=!0},ge=()=>{U.value==="myProblem"?X():Y()};return(l,a)=>{const _=De,p=$e,I=Xe,J=qe,y=Be,j=Ye,E=Le("router-link"),k=We,P=He,be=Fe,ye=Ve,Z=Qe,ee=Ke,te=Re,ae=ze,he=Ge,Ie=je,Ee=Je;return n(),i(f,null,[t("div",st,[s(ye,{class:"elcontainer"},{default:o(()=>[s(_,{class:"header"},{default:o(()=>[s(we,{page:ne.value},null,8,["page"])]),_:1}),s(be,{class:"elmain"},{default:o(()=>[t("div",ot,[s(j,{model:v,"label-width":"auto",inline:!0,rules:pe,ref_key:"formRef",ref:W},{default:o(()=>[s(I,{label:"题目集ID"},{default:o(()=>[s(p,{modelValue:v.colId,"onUpdate:modelValue":a[0]||(a[0]=e=>v.colId=e),disabled:"",placeholder:"题目ID会自动生成"},null,8,["modelValue"])]),_:1}),s(I,{label:"题目集名称",required:"",prop:"colName"},{default:o(()=>[s(p,{modelValue:v.colName,"onUpdate:modelValue":a[1]||(a[1]=e=>v.colName=e),placeholder:"请输入题目名称"},null,8,["modelValue"])]),_:1}),s(I,{label:"是否公开题目集",required:""},{default:o(()=>[s(J,{modelValue:N.value,"onUpdate:modelValue":a[2]||(a[2]=e=>N.value=e),"active-text":N.value?"题目也将被公开":"",style:{width:"148px"}},null,8,["modelValue","active-text"])]),_:1}),s(I,null,{default:o(()=>[t("div",nt,[s(y,{type:"success",onClick:a[3]||(a[3]=e=>fe(W.value))},{default:o(()=>[m("确认并保存")]),_:1}),s(y,{onClick:a[4]||(a[4]=()=>{L(oe).go(-1)})},{default:o(()=>[m("返回")]),_:1})])]),_:1})]),_:1},8,["model","rules"]),ct,s(xe,{name:"list",tag:"div",class:"problem-list"},{default:o(()=>[(n(!0),i(f,null,g(u.value,(e,h)=>(n(),i("div",{key:e.problemId,class:"problem",draggable:"true",onDragstart:r=>ie(r,h),onDragenter:r=>de(r,h),onDragend:me,onDragover:ue},[t("div",it,[s(y,{class:"deleteButton",icon:L(Me),circle:"",plain:"",type:"danger",onClick:r=>ce(e.problemName,h)},null,8,["icon","onClick"])]),t("div",dt,[e.userId==L(M).userId?(n(),b(E,{key:0,to:"/MyProblem/EditProblem/"+e.problemId},{default:o(()=>[s(y,{class:"editButton",icon:L(Ue),circle:"",plain:"",type:"info"},null,8,["icon"])]),_:2},1032,["to"])):q("",!0)]),t("div",{class:"status",style:z({color:e.status==0?"#67C23A":"#409EFF"})},c(e.status==0?"私有":"公开"),5),t("div",ut,c(e.problemId),1),s(E,{class:"name",to:`/Problem/WorkingArea/${e.problemId}`,draggable:"false"},{default:o(()=>[m(c(e.problemName),1)]),_:2},1032,["to"]),t("div",{class:V(A(e.difficultyLevel))},c(O(e.difficultyLevel)),3),s(P,{class:"tag-container"},{default:o(()=>[t("div",mt,[(n(!0),i(f,null,g(JSON.parse(e.tag),(r,le)=>(n(),b(k,{key:`${e.problemId}+${le}`,type:"success",class:"tag-item",round:""},{default:o(()=>[m(c(r),1)]),_:2},1024))),128))])]),_:2},1024),s(P,{class:"collection-container"},{default:o(()=>[t("div",vt,[(n(!0),i(f,null,g(JSON.parse(e.collection),(r,le)=>(n(),b(k,{key:r,type:"primary",class:"tag-item",round:""},{default:o(()=>[m(c(r),1)]),_:2},1024))),128))])]),_:2},1024)],40,rt))),128))]),_:1}),s(y,{type:"success",plain:"",round:"",icon:L(Te),onClick:a[5]||(a[5]=e=>_e())},{default:o(()=>[m("加入题目")]),_:1},8,["icon"])])]),_:1})]),_:1})]),s(Ie,{modelValue:T.value,"onUpdate:modelValue":a[13]||(a[13]=e=>T.value=e),"with-header":!1,size:"70%"},{default:o(()=>[s(he,{type:"border-card","tab-change":ge(),modelValue:U.value,"onUpdate:modelValue":a[12]||(a[12]=e=>U.value=e)},{default:o(()=>[Se((n(),b(ae,{label:"我的题目",name:"myProblem"},{default:o(()=>[pt,t("div",ft,[s(ee,{modelValue:u.value,"onUpdate:modelValue":a[6]||(a[6]=e=>u.value=e)},{default:o(()=>[(n(!0),i(f,null,g(Q.value,(e,h)=>(n(),i("div",{key:e.problemId,class:V(h%2==0?"problem one":"problem two")},[t("div",_t,[s(Z,{value:{problemId:e.problemId,userId:e.userId,problemName:e.problemName,difficultyLevel:e.difficultyLevel,tag:e.tag,collection:e.collection},label:K(e.problemId)},null,8,["value","label"])]),t("div",{class:"status",style:z({color:e.status==0?"#67C23A":"#409EFF"})},c(e.status==0?"私有":"公开"),5),t("div",gt,c(e.problemId),1),s(E,{class:"name",to:`/Problem/WorkingArea/${e.problemId}`,title:e.problemName},{default:o(()=>[m(c(e.problemName),1)]),_:2},1032,["to","title"]),t("div",{class:V(A(e.difficultyLevel))},c(O(e.difficultyLevel)),3),s(P,{class:"tag-container"},{default:o(()=>[t("div",bt,[(n(!0),i(f,null,g(JSON.parse(e.tag),r=>(n(),b(k,{type:"success",class:"tag-item",round:""},{default:o(()=>[m(c(r),1)]),_:2},1024))),256))])]),_:2},1024),s(P,{class:"collection-container"},{default:o(()=>[t("div",yt,[(n(!0),i(f,null,g(JSON.parse(e.collection),r=>(n(),b(k,{type:"primary",class:"tag-item",round:""},{default:o(()=>[m(c(r),1)]),_:2},1024))),256))])]),_:2},1024)],2))),128))]),_:1},8,["modelValue"])]),S.value>1?(n(),i("div",ht,[s(te,{background:"",layout:"prev, pager, next","page-count":S.value,class:"pagination",onChange:a[7]||(a[7]=e=>X()),"current-page":D.value,"onUpdate:currentPage":a[8]||(a[8]=e=>D.value=e)},null,8,["page-count","current-page"])])):q("",!0)]),_:1})),[[Ee,F.value]]),s(ae,{label:"公开题目",name:"publicProblem"},{default:o(()=>[It,t("div",Et,[s(ee,{modelValue:u.value,"onUpdate:modelValue":a[9]||(a[9]=e=>u.value=e)},{default:o(()=>[(n(!0),i(f,null,g(R.value,(e,h)=>(n(),i("div",{key:e.problemId,class:V(h%2==0?"problem one":"problem two")},[t("div",kt,[s(Z,{value:{problemId:e.problemId,userId:e.userId,problemName:e.problemName,difficultyLevel:e.difficultyLevel,tag:e.tag,collection:e.collection},label:K(e.problemId)},null,8,["value","label"])]),t("div",{class:"status",style:z({color:e.status==0?"#67C23A":"#409EFF"})},c(e.status==0?"私有":"公开"),5),t("div",Pt,c(e.problemId),1),s(E,{class:"name",to:`/Problem/WorkingArea/${e.problemId}`,title:e.problemName},{default:o(()=>[m(c(e.problemName),1)]),_:2},1032,["to","title"]),t("div",{class:V(A(e.difficultyLevel))},c(O(e.difficultyLevel)),3),s(P,{class:"tag-container"},{default:o(()=>[t("div",Nt,[(n(!0),i(f,null,g(JSON.parse(e.tag),r=>(n(),b(k,{type:"success",class:"tag-item",round:""},{default:o(()=>[m(c(r),1)]),_:2},1024))),256))])]),_:2},1024),s(P,{class:"collection-container"},{default:o(()=>[t("div",Ct,[(n(!0),i(f,null,g(JSON.parse(e.collection),r=>(n(),b(k,{type:"primary",class:"tag-item",round:""},{default:o(()=>[m(c(r),1)]),_:2},1024))),256))])]),_:2},1024)],2))),128))]),_:1},8,["modelValue"])]),B.value>1?(n(),i("div",Lt,[s(te,{background:"",layout:"prev, pager, next","page-count":B.value,class:"pagination",onChange:a[10]||(a[10]=e=>Y()),"current-page":$.value,"onUpdate:currentPage":a[11]||(a[11]=e=>$.value=e)},null,8,["page-count","current-page"])])):q("",!0)]),_:1})]),_:1},8,["tab-change","modelValue"])]),_:1},8,["modelValue"])],64)}}},aa=ke(Vt,[["__scopeId","data-v-ef75553f"]]);export{aa as default};
