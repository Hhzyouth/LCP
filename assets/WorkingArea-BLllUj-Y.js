import{al as _export_sfc,t as ref,az as useRoute,am as useUserStore,r as resolveComponent,o as openBlock,f as createElementBlock,m as createVNode,k as withCtx,ad as withKeys,w as withModifiers,ao as ElContainer,ap as _sfc_main$1,p as createBaseVNode,a7 as unref,x as createTextVNode,F as Fragment,v as renderList,n as normalizeClass,a6 as withDirectives,j as createBlock,y as toDisplayString,aq as ElHeader,at as ElButton,a9 as ElInput,as as ElMain,aU as d_caret_default,aV as arrow_left_bold_default,aW as full_screen_default,aX as arrow_down_bold_default,au as pushScopeId,av as popScopeId}from"./index-BXCC11IL.js";import{v as vLoading}from"./el-loading-eh5KfxWa.js";import{E as ElTag}from"./el-tag-YOrmE4kc.js";import{E as ElSelect,a as ElOption}from"./el-select-Bn9seCgH.js";import{E as ElScrollbar}from"./el-scrollbar-NpxurtvA.js";import{E as ElTabPane,a as ElTabs}from"./el-tab-pane-9eQCgsm8.js";import{p as python,c as cpp,j as java,g as go,r as run,a as confetti,s as se,b as getProblemContent,d as getProblemRecord}from"./confetti.module--Y_JIF_Y.js";import{g as getSolutions}from"./solution-BKf-_f2T.js";/* empty css                   */import{E as ElMessage}from"./index-e590A-XK.js";import"./strings-CBtOi6BX.js";import"./isEqual-W0GA-HSG.js";import"./_Uint8Array-KkRCjyoh.js";import"./debounce-DY7VrZO3.js";import"./castArray-BxmzwEdl.js";import"./index-DW1qeJdV.js";const _withScopeId=o=>(pushScopeId("data-v-ff0c9f03"),o=o(),popScopeId(),o),_hoisted_1=["onKeydown"],_hoisted_2=["innerHTML"],_hoisted_3={style:{width:"100%",margin:"6px"}},_hoisted_4=["id"],_hoisted_5={class:"card-header"},_hoisted_6={class:"solution-name"},_hoisted_7={style:{width:"30%"}},_hoisted_8={class:"card-content"},_hoisted_9=["innerHTML"],_hoisted_10=_withScopeId(()=>createBaseVNode("div",{style:{height:"30px"}},null,-1)),_hoisted_11=_withScopeId(()=>createBaseVNode("div",{class:"main-header"},[createBaseVNode("div",{class:"status"},"状态"),createBaseVNode("div",{class:"type"},"类型"),createBaseVNode("div",{class:"point"},"分数"),createBaseVNode("div",{class:"code"},"代码")],-1)),_hoisted_12={class:"status"},_hoisted_13={class:"type"},_hoisted_14={class:"point"},_hoisted_15={class:"code"},_hoisted_16={class:"working"},_hoisted_17={class:"coding"},_hoisted_18={class:"coding-top"},_hoisted_19=_withScopeId(()=>createBaseVNode("span",null,"代码",-1)),_hoisted_20={class:"coding-bottom"},_hoisted_21=_withScopeId(()=>createBaseVNode("span",null," 测试用例 ",-1)),_hoisted_22=_withScopeId(()=>createBaseVNode("span",null," 预期结果 ",-1)),_sfc_main={__name:"WorkingArea",setup(__props){const activeTab=ref("测试用例"),route=useRoute(),{p}=route.params,Page=ref("5"),runLoading=ref(!1),resultText=ref(""),content=ref(""),language=ref("python"),languageList={python:python(),cpp:cpp(),java:java(),go:go()},lang=ref(python()),codeVal=ref(""),result=ref(""),caseInput=ref(""),guessInput=ref(""),resultLoading=ref(!1),eltabs=ref("info"),recordLoading=ref(!1),records=ref([]),solutions=ref([]),togetProblemContent=()=>{getProblemContent(parseInt(p)).then(o=>{console.log(o);try{const a=Object.keys(JSON.parse(o.data.data.inputSample)).join(",");codeVal.value=`def main(${a}):`}catch{codeVal.value="def main():"}content.value=o.data.data.description,caseInput.value=o.data.data.inputSample,guessInput.value=o.data.data.outputSample})},toGetProblemRecord=()=>{getProblemRecord(parseInt(p)).then(o=>{console.log(o),records.value=o.data.data,recordLoading.value=!1}).catch(o=>{ElMessage.error("网络错误")})},store=useUserStore(),runCode=()=>{runLoading.value=!0,resultLoading.value=!0,resultText.value="",run(codeVal.value,store.userId,parseInt(p)).then(function(o){runLoading.value=!1,resultLoading.value=!1,result.value=o.data.data,activeTab.value="运行结果",resultText.value=showResult(),toGetProblemRecord()})},showResult=()=>{console.log(result.value);const temp=eval(result.value);return temp[2]===0?(cheer(),"所有用例已通过"):transStatus(temp)+`
错误信息
${temp[1].split("$").join(`
`)}
控制台输出
${temp[3]}`},theme={".cm-content":{fontSize:"14px",fontFamily:'Consolas, "Courier New", monospace'}},leftClass=ref("content"),bottomClass=ref("result"),leftCloseButton=ref("closeButton"),bottomCloseButton=ref("closeButton"),changeLang=()=>{lang.value=languageList[language.value]},leftController=()=>{leftClass.value=="content"?(leftClass.value="content-close",leftCloseButton.value="closeButton-close"):(leftClass.value="content",leftCloseButton.value="closeButton")},bottomController=()=>{bottomClass.value=="result"?(bottomClass.value="result-close",bottomCloseButton.value="closeButton-close"):(bottomClass.value="result",bottomCloseButton.value="closeButton")},allController=()=>{leftClass.value=="content-close"&&bottomClass.value=="result-close"?(leftClass.value="content",bottomClass.value="result",leftCloseButton.value="closeButton",bottomCloseButton.value="closeButton"):(bottomClass.value="result-close",leftClass.value="content-close",bottomCloseButton.value="closeButton-close",leftCloseButton.value="closeButton-close")},langList=[{value:"python",label:"Python"},{value:"java",label:"Java"},{value:"cpp",label:"C++"},{value:"go",label:"Go"}],transStatus=r=>{const t=eval(r);switch(t[2]){case 0:return"正确";case 1:return"超出时间限制";case 2:return"运行错误";case 3:return"编译错误";case 4:return"答案错误"}return""},statusClass=r=>{console.log(r);const t=eval(r);switch(t[2]){case 0:return"green";case 4:return"red";default:return"orange"}},transType=o=>o===1?"练习":"竞赛",last=ref(""),tabChange=()=>{eltabs.value==="info"&&eltabs.value!==last.value?(togetProblemContent(),last.value="info"):eltabs.value==="record"&&eltabs.value!==last.value?(last.value="record",recordLoading.value=!0,toGetProblemRecord()):eltabs.value!==last.value&&(last.value="solution",getSolutions(parseInt(p),1).then(o=>{console.log(o),solutions.value=o.data.data}))},cheer=()=>{confetti({particleCount:500,angle:60,spread:90,startVelocity:70,ticks:300,gravity:1.2,origin:{x:0}}),confetti({particleCount:500,angle:120,spread:90,ticks:300,gravity:1.2,startVelocity:70,origin:{x:1}})},extend=o=>{console.log(o),document.getElementById(o).classList.toggle("active")};return(o,a)=>{const d=ElHeader,n=ElScrollbar,s=ElTabPane,l=ElButton,_=resolveComponent("router-link"),m=ElTag,u=ElTabs,v=ElOption,f=ElSelect,i=ElInput,g=ElMain,h=ElContainer,V=vLoading;return openBlock(),createElementBlock("div",{class:"Header-Main-container",onKeydown:withKeys(withModifiers(()=>{},["prevent"]),["9","native"])},[createVNode(h,null,{default:withCtx(()=>[createVNode(d,{class:"elheader"},{default:withCtx(()=>[createVNode(_sfc_main$1,{page:Page.value},null,8,["page"])]),_:1}),createVNode(g,{class:"elmain"},{default:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(leftClass.value)},[createVNode(u,{type:"card",class:"eltabs",modelValue:eltabs.value,"onUpdate:modelValue":a[0]||(a[0]=e=>eltabs.value=e),"tab-change":tabChange()},{default:withCtx(()=>[createVNode(s,{label:"题目信息",class:"pane",name:"info"},{default:withCtx(()=>[createVNode(n,null,{default:withCtx(()=>[createBaseVNode("div",{innerHTML:content.value,style:{"overflow-y":"auto",height:"100%"}},null,8,_hoisted_2)]),_:1})]),_:1}),createVNode(s,{label:"题解",class:"pane solutions",name:"solution"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_3,[createVNode(_,{to:"/MyProblem/EditSolution/"+unref(p)+"/0",target:"_blank"},{default:withCtx(()=>[createVNode(l,{type:"success",plain:"",round:""},{default:withCtx(()=>[createTextVNode("+ 发布题解")]),_:1})]),_:1},8,["to"])]),createVNode(n,null,{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(solutions.value,e=>(openBlock(),createElementBlock("div",{class:"solution-card",key:e.solutionId,id:e.solutionId},[createBaseVNode("div",_hoisted_5,[createBaseVNode("div",_hoisted_6,toDisplayString(e.solutionName),1),createBaseVNode("div",_hoisted_7,[(openBlock(!0),createElementBlock(Fragment,null,renderList(JSON.parse(e.tag),c=>(openBlock(),createBlock(m,{type:"success",class:"tag-item",round:""},{default:withCtx(()=>[createTextVNode(toDisplayString(c),1)]),_:2},1024))),256))])]),createBaseVNode("div",_hoisted_8,[createVNode(n,{class:"solution-html"},{default:withCtx(()=>[createBaseVNode("div",{innerHTML:e.content,style:{"overflow-y":"auto",height:"100%"}},null,8,_hoisted_9)]),_:2},1024)]),createVNode(l,{onClick:c=>extend(e.solutionId),icon:unref(d_caret_default),circle:"",class:"fullButton",style:{position:"absolute",right:"8px",bottom:"8px"}},null,8,["onClick","icon"])],8,_hoisted_4))),128)),_hoisted_10]),_:1})]),_:1}),createVNode(s,{label:"提交记录",class:"pane",name:"record"},{default:withCtx(()=>[createVNode(n,null,{default:withCtx(()=>[_hoisted_11,(openBlock(!0),createElementBlock(Fragment,null,renderList(records.value.slice().reverse(),(e,c)=>(openBlock(),createElementBlock("div",{class:normalizeClass(c%2===0?"record one":"record two")},[createBaseVNode("div",_hoisted_12,[createBaseVNode("div",{class:normalizeClass(statusClass(e.returnValue)),style:{padding:"2px 7px","border-radius":"8px",color:"white"}},toDisplayString(transStatus(e.returnValue)),3)]),createBaseVNode("div",_hoisted_13,toDisplayString(transType(e.recordType)),1),createBaseVNode("div",_hoisted_14,toDisplayString(e.recordType===1?"-":e.point),1),createBaseVNode("div",_hoisted_15,[createVNode(l,{text:"",type:"primary",style:{height:"80%",padding:"5px"},onClick:C=>codeVal.value=e.submit},{default:withCtx(()=>[createTextVNode("载入代码>")]),_:2},1032,["onClick"])])],2))),256))]),_:1})]),_:1})]),_:1},8,["modelValue","tab-change"]),createVNode(l,{class:normalizeClass(leftCloseButton.value),type:"info",icon:unref(arrow_left_bold_default),circle:"",style:{position:"absolute",top:"5px",right:"5px"},onClick:leftController},null,8,["class","icon"])],2),createBaseVNode("div",_hoisted_16,[createBaseVNode("div",_hoisted_17,[createBaseVNode("div",_hoisted_18,[_hoisted_19,createBaseVNode("div",null,[createVNode(f,{modelValue:language.value,"onUpdate:modelValue":a[1]||(a[1]=e=>language.value=e),style:{width:"100px","margin-right":"8px"},change:changeLang()},{default:withCtx(()=>[(openBlock(),createElementBlock(Fragment,null,renderList(langList,e=>createVNode(v,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","change"]),createVNode(l,{class:"fullButton",icon:unref(full_screen_default),circle:"",onClick:allController},null,8,["icon"])])]),createVNode(unref(se),{basic:"",lang:lang.value,modelValue:codeVal.value,"onUpdate:modelValue":a[2]||(a[2]=e=>codeVal.value=e),style:{height:"0",flex:"1"},theme,tab:!0},null,8,["lang","modelValue"]),createBaseVNode("div",_hoisted_20,[createVNode(l,{class:"runButton",onClick:a[3]||(a[3]=e=>cheer())},{default:withCtx(()=>[createTextVNode("运行")]),_:1}),createVNode(l,{type:"success",onClick:runCode,loading:runLoading.value},{default:withCtx(()=>[createTextVNode("提交")]),_:1},8,["loading"])])]),createBaseVNode("div",{class:normalizeClass(bottomClass.value)},[createVNode(u,{type:"card",class:"eltabsResult",modelValue:activeTab.value,"onUpdate:modelValue":a[6]||(a[6]=e=>activeTab.value=e)},{default:withCtx(()=>[createVNode(s,{name:"测试用例",label:"测试用例",class:"paneResult"},{default:withCtx(()=>[_hoisted_21,createVNode(i,{modelValue:caseInput.value,"onUpdate:modelValue":a[4]||(a[4]=e=>caseInput.value=e),style:{width:"95%",margin:"8px 0"},placeholder:"测试用例",class:"elinput",type:"textarea",autosize:"",resize:"none"},null,8,["modelValue"]),_hoisted_22,createVNode(i,{modelValue:guessInput.value,"onUpdate:modelValue":a[5]||(a[5]=e=>guessInput.value=e),style:{width:"95%",margin:"8px 0"},placeholder:"预期结果",class:"elinput",type:"textarea",autosize:"",resize:"none"},null,8,["modelValue"])]),_:1}),withDirectives((openBlock(),createBlock(s,{name:"运行结果",label:"运行结果",class:"paneResult"},{default:withCtx(()=>[createTextVNode(toDisplayString(resultText.value),1)]),_:1})),[[V,resultLoading.value]])]),_:1},8,["modelValue"]),createVNode(l,{class:normalizeClass(bottomCloseButton.value),type:"info",icon:unref(arrow_down_bold_default),circle:"",style:{position:"absolute",top:"5px",right:"5px"},onClick:bottomController},null,8,["class","icon"])],2)])]),_:1})]),_:1})],40,_hoisted_1)}}},WorkingArea=_export_sfc(_sfc_main,[["__scopeId","data-v-ff0c9f03"]]);export{WorkingArea as default};
